/* ---------------------------------------
   Fonts & base variables
--------------------------------------- */
@import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap');

:root{
  --primary: #E30613;
  --accent: #3498db;
  --correct: #00A651;
  --incorrect: #E30613;
  --background: #F5F5F5;
  --card-background: #FFFFFF;
  --text-color: #333333;
  --current:      #4F46E5;  
  --current-deep: #4338CA;  

  --text-secondary: #666;
  --warning: #FF8C00;

  --radius: 14px;
  --radius-lg: 18px;

  --shadow-1: 0 2px 8px rgba(0,0,0,.08);
  --shadow-2: 0 6px 24px rgba(0,0,0,.12);

  --tr: .22s cubic-bezier(.4,0,.2,1);
}

*{ box-sizing: border-box; }
html, body{ height:100%; }
/* kill horizontal panning on mobile entirely */
/* No horizontal scroll, app-like vertical pan only */
html, body {
  max-width: 100%;
  overflow-x: hidden;
  overscroll-behavior-x: none;
  touch-action: pan-y;
  -webkit-font-smoothing: antialiased;
}
body, #welcomeScreen, #gameContainer {
  min-height: 100svh; /* handles mobile dynamic toolbars */
}
#gameContainer{
  padding-top: var(--app-header-height);
}
body{
  margin:0;
  font-family: 'Open Sans', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color: var(--text-color);
  background: linear-gradient(135deg, var(--background) 0%, #e9ecef 100%);
  line-height: 1.55;
}

@media (max-width: 768px){
  .welcome-screen, .game-container { border-radius: 0; margin: 0; }
}

/* Only allow vertical panning (helps iOS) */
body, .game-container, .rosco-container {
  touch-action: pan-y;
}

/* ---------------------------------------
   Generic buttons
--------------------------------------- */
button{
  -webkit-tap-highlight-color: transparent;
  appearance: none; border: 0; cursor: pointer;
  border-radius: 999px; padding: 12px 22px; min-width: 120px;
  font-weight: 700; letter-spacing: .02em; text-transform: uppercase;
  color:#fff; background: linear-gradient(135deg, var(--primary), color-mix(in srgb, var(--primary) 82%, #000));
  box-shadow: var(--shadow-1);
  transition: transform var(--tr), box-shadow var(--tr), background var(--tr), opacity var(--tr);
}
button:hover{ transform: translateY(-1px); box-shadow: var(--shadow-2); }
button:active{ transform: translateY(0); }
button:disabled{ opacity:.55; cursor:not-allowed; box-shadow:none; }
.btn-pass{ background: linear-gradient(135deg, var(--warning), #e67300); }


.hint-icon{
  flex:0 0 auto;
  width:36px; height:36px; padding:0; min-width:auto;
  display:inline-flex; align-items:center; justify-content:center;
  cursor:pointer;
  background:#16a34a; color:#fff; border:0;
  border-radius:10px;
  box-shadow:0 6px 16px rgba(22,163,74,.35);
}
.hint-icon:hover{ filter:brightness(1.05); }
.hint-icon svg path{ stroke:#fff; fill:none; }

/* ---------------------------------------
   Loading
--------------------------------------- */
.loading-screen{
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center;
  background: linear-gradient(135deg, var(--background), #e8e8e8);
  z-index:10000;
}
.loading-content{ text-align:center; color: var(--primary); }
.spinner{
  width:50px;height:50px;border:4px solid rgba(227,6,19,.25);
  border-top:4px solid var(--primary); border-radius:50%;
  animation: spin 1s linear infinite; margin:0 auto 16px;
}
@keyframes spin{ to{ transform: rotate(360deg);} }

/* ---------------------------------------
   Welcome Screen (home)
--------------------------------------- */
.welcome-screen{
  min-height:100vh; display:flex; align-items:center; justify-content:center;
  padding: 40px 16px;
}
.welcome-container{
  width:100%; max-width: 920px; background: var(--card-background);
  border-radius: 22px; box-shadow: var(--shadow-2); overflow:hidden;
}
.welcome-header{
  padding: 36px 26px; color:#fff;
  background: linear-gradient(135deg, var(--primary), color-mix(in srgb, var(--primary) 80%, #000));
  position:relative;
}
.welcome-logo{ max-width:200px; margin:0 auto 16px; }
.welcome-title{ margin:0 0 6px; text-align:center; font-size:2rem; font-weight:800; letter-spacing:.01em; }
.welcome-subtitle{ margin:0; text-align:center; opacity:.9; }

.welcome-content{ padding: 26px; }

.game-rules{ max-width: 760px; margin: 0 auto; }
.game-rules h3{ margin:0 0 14px; color: var(--primary); font-size:1.3rem; }
.rules-grid{
  display:grid; gap:18px; grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
  margin-bottom:22px;
}
.rule-item{
  background: linear-gradient(135deg, #fafafa, #f1f1f1);
  border-left: 4px solid var(--primary);
  border-radius: 12px; padding:16px; box-shadow: var(--shadow-1);
}
.rule-item h4{ margin:0 0 8px; color: var(--primary); font-weight:700; }
.rule-item p{ margin:0; color: var(--text-secondary); }

.scoring-table{
  border:1px solid #eee; border-radius: 12px; padding: 16px; background: #fff;
  box-shadow: var(--shadow-1); max-width: 760px; margin: 16px auto 0;
}
.scoring-table h4{ margin:0 0 10px; color:var(--primary); }
.scoring-row{ display:flex; justify-content:space-between; padding:8px 0; border-bottom:1px solid #f2f2f2; }
.scoring-row:last-child{ border-bottom:0; font-weight:700; color: var(--primary); }

.action-buttons{
  display:flex; gap:14px; justify-content:center; flex-wrap:wrap; margin-top:20px;
}

/* ---------------------------------------
   Game Container
--------------------------------------- */
.game-container{
  width:100%; max-width: 1000px; margin: 18px auto; padding: 16px;
  background: var(--card-background); border-radius: 22px; box-shadow: var(--shadow-2);
}

/* Compact header */
.compact-header{
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1100;

  width: 100%;       /* no 100vw / negative margins needed */
  margin: 0;
  border-radius: 0;  /* no rounded corners on the header */
  box-shadow: 0 8px 24px rgba(0,0,0,.12);
  transform: translateZ(0); /* avoid iOS repaint glitches */
}
.header-top{
  display:flex; align-items:center; justify-content:space-between;
  background: linear-gradient(135deg, var(--primary), color-mix(in srgb, var(--primary) 80%, #000));
  color:#fff;
  padding: 10px 14px;
  padding-top: calc(10px + env(safe-area-inset-top, 0px));
}
:root{ --app-header-height: 120; } /* tune if your header height changes */
html { scroll-padding-top: var(--app-header-height); }

@media (max-width: 768px){
  .header-top,
  .header-stats{
    padding-left: 16px;
    padding-right: 16px;
  }
}
.compact-header h1 { margin:0; font-size:1.1rem; font-weight:700; letter-spacing:.02em; }
/* --- restore the compact circular back button --- */
.back-home{
  padding: 0 !important;
  min-width: 0 !important;
  width: 34px !important;
  height: 34px !important;
  border-radius: 50% !important;
  background: rgba(255,255,255,.14) !important;
  color: #fff !important;
  box-shadow: none !important;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
.back-home:hover{ background: rgba(255,255,255,.22) !important; }
.back-home svg{ width: 20px; height: 20px; color: currentColor; }

.header-stats{
  display:grid; grid-template-columns: repeat(5, minmax(0,1fr)); gap:6px;
  background: #f6f7f8; padding:10px 12px; border-bottom:1px solid #e5e5e5;
}
.stat.mini{
  background:#fff; border:1px solid #e9e9e9; border-radius:10px;
  padding:8px 10px; text-align:center;
}
.stat.mini span{ display:block; font-size:.68rem; color:#667; letter-spacing:.06em; }
.stat.mini strong{ font-size:1.1rem; color:#0f2233; }

/* Timer pill */
#timer.timer-mini{
  align-self:stretch; display:flex; align-items:center; justify-content:center;
  background: linear-gradient(135deg, var(--accent) 0%, color-mix(in srgb, var(--accent) 80%, #000) 100%);
  color:#fff; font-weight:800; border-radius:10px; border:3px solid rgba(255,255,255,.25);
}
#timer.timer-mini.timer-urgent{
  background: linear-gradient(135deg, #FF4444 0%, #CC0000 100%) !important;
  animation: pulse-urgent 1s infinite;
}
@keyframes pulse-urgent {
  0%,100% { transform: none; box-shadow: 0 4px 16px rgba(0,0,0,.12); }
  50% { transform: scale(1.03); box-shadow: 0 10px 28px rgba(255,0,0,.35); }
}

/* ---------------------------------------
   Rosco
--------------------------------------- */
/* Rosco scales with viewport safely */
.rosco-container{
  position: relative;
  width: min(440px, 100vw - 24px);
  aspect-ratio: 1 / 1;
  height: auto;
  margin: 14px auto;
  overflow: hidden;
  touch-action: pan-y;      /* no horizontal drag */
}


.rosco { position: relative; width: 100%; height: 100%; }

.current-letter{
  position:absolute; inset:0;
  display:flex; align-items:center; justify-content:center;
  font-size: clamp(48px, 20vw, 84px);
  font-weight:900;
  color: var(--current);   
  opacity:.06;
  z-index:0;
}
/* Center logo inside the rosco */
.center-image{
  position: absolute;               /* <-- critical */
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 32%;
  height: 32%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1;                       /* above .current-letter (z-index:0) */
  pointer-events: none;             /* never intercept taps */
}

#centerLogo{
  max-width: 100%;
  max-height: 100%;
  display: block;
}

.letter{
  position:absolute;
  width: clamp(42px, 12vw, 56px);
  height: clamp(42px, 12vw, 56px);
  border-radius:50%;
  background: linear-gradient(135deg, #fff, #f7f7f7);
  border:2px solid #e4e4e4; color: var(--primary);
  font-weight:800; font-size: clamp(14px, 3.6vw, 18px);
  display:flex; align-items:center; justify-content:center;
  cursor: default; box-shadow: var(--shadow-1);
  transition: transform var(--tr), box-shadow var(--tr), background var(--tr), color var(--tr), border-color var(--tr);
}
.letter.correct{
  background: linear-gradient(135deg, var(--correct), color-mix(in srgb, var(--correct) 80%, #000));
  color:#fff; border-color: var(--correct); transform: scale(1.12);
  box-shadow: 0 0 18px color-mix(in srgb, var(--correct) 35%, transparent);
}
.letter.incorrect{
  background: linear-gradient(135deg, var(--incorrect), color-mix(in srgb, var(--incorrect) 82%, #000));
  color:#fff; border-color: var(--incorrect); transform: scale(.96);
  box-shadow: 0 0 18px color-mix(in srgb, var(--incorrect) 35%, transparent);
}
.letter.passed{
  background: linear-gradient(135deg, var(--warning), #e67300);
  color:#fff; border-color: #e07a00;
  box-shadow: 0 0 16px rgba(255,140,0,.28);
}
.letter.current{
  background: linear-gradient(135deg, var(--current), var(--current-deep));
  color:#fff;
  border-color: rgba(255,255,255,.85);
  transform: scale(1.22);
  animation: glow-current 1.8s infinite;
}

@keyframes glow-current{
  0%,100%{ box-shadow: 0 0 22px color-mix(in srgb, var(--current) 60%, transparent); }
  50%    { box-shadow: 0 0 32px color-mix(in srgb, var(--current) 85%, transparent); }
}
.letter.unanswered{
  background: linear-gradient(135deg, #f6f6f6, #eee);
  color: var(--text-secondary); border-color:#e2e2e2; filter: grayscale(35%); opacity:.85;
}

/* ---------------------------------------
   Question block (inside action bar)
--------------------------------------- */
.game-info{
  position:relative; background: linear-gradient(135deg, #fafafa, #f1f1f1);
  border:1px solid #e7e7e7; border-radius: 14px; padding: 12px;
  box-shadow: inset 0 2px 8px rgba(0,0,0,.04);
}
.game-info.in-bar{ margin-bottom: 10px; }
#definition{ margin:0; font-size: 1.05rem; font-weight:600; color: var(--text-color); }
.preview-mode #definition{ color: var(--text-secondary); font-style: italic; }

.question-row{ display:flex; align-items:flex-start; gap:10px; }
.question-row p{ flex:1; }

.fuzzy-hint{
  margin-top:10px; padding:10px 12px; border-radius: 10px;
  background: linear-gradient(135deg, rgba(255,140,0,.1), rgba(255,140,0,.22));
  color: var(--warning); border-left:4px solid var(--warning);
  box-shadow: var(--shadow-1); font-weight:600;
}

/* ---------------------------------------
   Answer input + buttons
--------------------------------------- */
.input-container{ display:flex; justify-content:center; margin: 10px 0; }
input#answer{
  width: 360px; max-width: 100%; text-align:center;
  padding: 14px 18px; font-size: 1.05rem; font-weight:700; letter-spacing:.02em;
  background:#fff; border:2px solid #e2e2e2; border-radius: 999px;
  outline: none; transition: border-color var(--tr), box-shadow var(--tr), transform var(--tr);
  box-shadow: inset 0 2px 8px rgba(0,0,0,.05);
}
input#answer:focus{
  border-color: var(--primary);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary) 22%, transparent), inset 0 2px 8px rgba(0,0,0,.05);
  transform: translateY(-1px);
}

.btn-row{ display:flex; gap:12px; margin: 12px 0 4px; }
.btn-row button{ flex:1; min-width:0; }

/* ---------------------------------------
   Final score + results
--------------------------------------- */
#finalScore{
  margin: 18px 0; padding: 18px; border-radius: 14px;
  background: linear-gradient(135deg, #fafafa, #f1f1f1);
  border-left: 4px solid var(--primary); box-shadow: var(--shadow-1);
}
.points-breakdown{
  margin-top:12px; padding: 14px; border-radius: 12px;
  background: linear-gradient(135deg, rgba(227,6,19,.06), rgba(227,6,19,.12));
  border:1px solid rgba(227,6,19,.18);
}
.points-breakdown h3{ margin:0 0 8px; color: var(--primary); text-align:center; }
.total-points{
  margin-top:10px; text-align:center; font-size:1.3rem; font-weight:800; color: var(--primary);
  border:2px solid var(--primary); border-radius: 12px; padding:10px; background:#fff;
}

#results{ margin-top:16px; }
.results-container{
  background:#fff; border:1px solid #eee; border-radius: 16px; padding: 22px; box-shadow: var(--shadow-2);
}
.results-header{ text-align:center; padding-bottom:14px; border-bottom:2px solid #eee; }
.results-header h2{ margin:0; color: var(--primary); }
.results-summary{
  display:grid; gap:14px; grid-template-columns: repeat(auto-fit,minmax(140px,1fr));
  background: linear-gradient(135deg, #fafafa, #f1f1f1);
  border:1px solid #eee; border-radius: 12px; padding: 14px; margin: 16px 0;
}
.summary-item{ background:#fff; border:1px solid #eee; border-radius: 10px; padding:12px; text-align:center; }
.summary-label{ font-size:.82rem; color:var(--text-secondary); }
.summary-value{ font-size:1.6rem; font-weight:800; }
.summary-value.correct{ color: var(--correct); }
.summary-value.incorrect{ color: var(--incorrect); }
.summary-value.neutral{ color: var(--primary); }

/* ---------------------------------------
   Sticky action bar
   (desktop => normal flow; mobile => fixed; keyboard-aware)
--------------------------------------- */
.actionbar{ }
@media (max-width: 768px){
  /* Reserve space so content never hides under the bar */
  .game-container{ padding-bottom: calc(160px + env(safe-area-inset-bottom)); }

  .actionbar{
    position: fixed; left: 0; right: 0; bottom: 0; z-index: 1000;
    background: var(--card-background);
    border-top: 1px solid #e7e7e7;
    box-shadow: 0 -8px 24px rgba(0,0,0,.12);
    padding: 12px 16px calc(12px + env(safe-area-inset-bottom));
  }
  .actionbar .game-info, .actionbar .input-container, .actionbar .btn-row{
    max-width: 760px; margin-left: auto; margin-right: auto;
  }
  .actionbar .input-container{ margin: 8px 0; }
  .actionbar .btn-row{ margin: 0; gap: 10px; }
}

/* ---------------------------------------
   Countdown overlay
--------------------------------------- */
#countdownOverlay{
  position: fixed; inset: 0;
  background: rgba(0,0,0,.55); display:none;
  align-items:center; justify-content:center; z-index: 100000; backdrop-filter: blur(2px);
}
#countdownOverlay.show{ display:flex; }
#countdownNumber{
  font: 900 120px/1 'Open Sans', sans-serif;
  color:#fff; text-shadow: 0 10px 40px rgba(0,0,0,.35);
  animation: pop 1s ease-out infinite;
}
@keyframes pop{ 0%{ transform: scale(.6); opacity:.2; } 50%{ transform: scale(1.1); opacity:1; } 100%{ transform: scale(1); opacity:.85; } }

/* ---------------------------------------
   Print
--------------------------------------- */
@media print{
  body *{ visibility: hidden; }
  #results, #results *{ visibility: visible; }
  #results{ position:absolute; inset:0; width:100%; background:none; box-shadow:none; }
}

/* Buttons with icons */
.with-ico{ display:inline-flex; align-items:center; justify-content:center; gap:10px; }
.with-ico svg{ width:18px; height:18px; flex:0 0 auto; color:#fff; opacity:.95; }

/* Hide the sticky bar when game ends */
.actionbar.hidden{ display:none; }

/* Hint toast (appears above the sticky bar) */
.hint-toast{
  position:absolute;
  left:16px; right:16px; bottom: calc(100% + 10px);
  background:#0ea5e9;           /* info tint */
  color:#fff;
  border-radius:12px;
  padding:10px 12px;
  font-weight:700;
  box-shadow:0 10px 24px rgba(0,0,0,.18);
  opacity:0; transform: translateY(6px);
  pointer-events:none;
  transition: opacity .18s ease, transform .18s ease;
}
.hint-toast.show{ opacity:1; transform: translateY(0); }


/* Show a placeholder whenever the definition is temporarily empty */
#actionBar #definition:empty::before{
  content: "Loading game…";
  color: var(--text-secondary);
  font-style: italic;
  opacity: .9;
}

input#answer{
  font-size: 16px; /* prevents iOS auto-zoom on focus */
}

/***** App-like: no accidental text selection *****/
.no-select, .compact-header, .header-stats, .rosco-container, .letter, .actionbar {
  -webkit-user-select: none; user-select: none;
  -webkit-touch-callout: none;
}
/* Inputs remain selectable */
input, textarea { -webkit-user-select: text; user-select: text; -webkit-touch-callout: default; }

button { touch-action: manipulation; }